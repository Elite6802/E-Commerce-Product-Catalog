import React, { useEffect, useState } from "react";

export default function DarkToggle() {
  const [on, setOn] = useState(() => {
    try {
      return localStorage.getItem("theme") === "dark";
    } catch { return false; }
  });

  useEffect(() => {
    if (on) document.documentElement.classList.add("dark");
    else document.documentElement.classList.remove("dark");
    try { localStorage.setItem("theme", on ? "dark" : "light"); } catch {
        // do nothing
    }
  }, [on]);

  return (
    <button
      onClick={() => setOn(!on)}
      className="p-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-slate-900 transition-colors text-neutral-900 dark:text-white"
      title={on ? "Switch to light mode" : "Switch to dark mode"}
    >
      {on ? (
        <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path d="M21.64 15.95c-.14-.94-.69-1.82-1.49-2.44-.79-.61-1.85-.85-2.89-.68.96-1.34 1.54-3 1.54-4.83 0-4.42-3.58-8-8-8-4.18 0-7.7 3.18-7.98 7.23-.62.05-1.21.12-1.78.26-1.15.24-2.23.71-3.15 1.37-.92.66-1.64 1.52-2.12 2.51C-.11 15.59.09 17.8 1.45 19.44s3.2 2.66 5.22 2.66c.98 0 1.95-.17 2.89-.5.82 1.58 2.12 2.9 3.73 3.76 1.6.86 3.41 1.02 5.14.47 1.73-.55 3.2-1.75 4.14-3.35.95-1.6 1.22-3.56.73-5.39zm-16.5-2.92c.27-.11.56-.2.86-.28C5.98 5.85 9.07 3 12.73 3c3.18 0 5.97 2.17 6.8 5.07-1.84.33-3.52 1.25-4.76 2.61-.55-.84-1.26-1.62-2.09-2.26-1.95-1.52-4.61-1.86-7 -.92zm-4.98 6.24c.34-.58.85-1.08 1.47-1.4.62-.32 1.29-.45 1.96-.39-.09.3-.17.6-.21.92-.13.84-.12 1.69.01 2.5-.66.17-1.33.08-1.96-.28-.64-.36-1.17-.96-1.49-1.69-.32-.73-.36-1.54-.18-2.32-.14 0-.27.01-.41.02-.45-.08-.85-.02-1.22.2.69.47 1.14 1.22 1.3 1.96.15.74.08 1.51-.12 2.23zm-1.64-4.94l.47-.11c.38-.09.74-.22 1.09-.37.74.72 1.74 1.38 2.92 1.78-.04.32-.07.65-.07.99-.01.83.08 1.65.25 2.45-.13.05-.26.1-.38.15-.63.31-1.17.81-1.53 1.43-.37.63-.53 1.33-.47 2.04-.26.11-.52.2-.79.27-.68-.03-1.32-.18-1.88-.5.06-.43.16-.86.3-1.25.14-.39.32-.76.54-1.09.22-.33.47-.63.74-.9zm6.58-8.03c1.16 0 2.32.4 3.25 1.15.93.75 1.6 1.8 1.85 2.99-.29.17-.58.38-.86.62-.28.24-.54.5-.78.78-.47-.36-1.03-.66-1.64-.84-.32-.1-.66-.15-1.00-.15-1.6 0-2.99 1.29-2.99 2.99s1.39 2.99 2.99 2.99c.34 0 .68-.05 1.00-.15.61-.18 1.17-.48 1.64-.84.24.28.50.54.78.78.28.24.57.45.86.62-.25 1.19-.92 2.24-1.85 2.99-.93.75-2.09 1.15-3.25 1.15-.7 0-1.39-.15-2.04-.43.15-.82.22-1.67.21-2.54 0-.87-.06-1.72-.21-2.54.65-.28 1.34-.43 2.04-.43z"/>
        </svg>
      ) : (
        <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path d="M12 18C6.48 18 2 13.52 2 8c0-.91.126-1.786.348-2.63C1.425 6.74 1 7.97 1 9.35 1 15.03 5.97 20 11.65 20c1.38 0 2.61-.425 3.63-.348C13.786 21.874 12.91 22 12 22c-5.52 0-10-4.48-10-10s4.48-10 10-10c5.52 0 10 4.48 10 10 0 .91-.126 1.786-.348 2.63C22.575 12.26 23 11.03 23 9.65 23 3.97 18.03-1 12.35-1 10.97-1 9.74-.575 8.72.348 11.214.126 12.09 0 13 0c5.52 0 10 4.48 10 10s-4.48 10-10 10z"/>
        </svg>
      )}
    </button>
  );
}
